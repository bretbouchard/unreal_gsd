---
phase: 12-production-enhancements
plan: 8
type: execute
wave: 4
depends_on: []
files_modified:
  - Plugins/GSD_Core/Source/GSD_Core/Public/DataAssets/GSDAccessibilityConfig.h
  - Plugins/GSD_Core/Source/GSD_Core/Private/DataAssets/GSDAccessibilityConfig.cpp
  - Plugins/GSD_Core/Source/GSD_Core/Public/Subsystems/GSDAccessibilityManager.h
  - Plugins/GSD_Core/Source/GSD_Core/Private/Subsystems/GSDAccessibilityManager.cpp
autonomous: true
must_haves:
  truths:
    - "Accessibility settings configurable"
    - "Color blind modes supported"
    - "Text scaling implemented"
  artifacts:
    - path: "Plugins/GSD_Core/Source/GSD_Core/Public/DataAssets/GSDAccessibilityConfig.h"
      provides: "Accessibility configuration"
      contains: "bHighContrastMode|ColorBlindType|TextScale"
---

<objective>
Create accessibility configuration system for visual and interaction accommodations.

Purpose: Council review (unreal-interface-rick) identified lack of accessibility support. This plan creates a configuration system for color blind modes, text scaling, and other accommodations.

Output: Accessibility configuration DataAsset and manager subsystem for applying settings.

Council Issues: unreal-interface-rick CRITICAL #2 - No accessibility module
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-production-enhancements/12-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GSDAccessibilityConfig DataAsset</name>
  <files>
    Plugins/GSD_Core/Source/GSD_Core/Public/DataAssets/GSDAccessibilityConfig.h
    Plugins/GSD_Core/Source/GSD_Core/Private/DataAssets/GSDAccessibilityConfig.cpp
  </files>
  <action>
Create accessibility configuration DataAsset.

**GSDAccessibilityConfig.h:**
```cpp
#pragma once

#include "CoreMinimal.h"
#include "Engine/DataAsset.h"
#include "GSDAccessibilityConfig.generated.h"

/** Types of color blindness */
UENUM(BlueprintType)
enum class EGSDColorBlindType : uint8
{
    None            UMETA(DisplayName = "None"),
    Deuteranope     UMETA(DisplayName = "Deuteranopia (Red-Green)"),
    Protanope       UMETA(DisplayName = "Protanopia (Red-Green)"),
    Tritanope       UMETA(DisplayName = "Tritanopia (Blue-Yellow)"),
    Achromatope     UMETA(DisplayName = "Achromatopsia (Monochrome)")
};

/** Visual accessibility settings */
USTRUCT(BlueprintType)
struct FGSDVisualAccessibilitySettings
{
    GENERATED_BODY();

    // High contrast mode for better visibility
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    bool bHighContrastMode = false;

    // Color blind correction type
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    EGSDColorBlindType ColorBlindType = EGSDColorBlindType::None;

    // Color blind correction strength (0-1)
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float ColorBlindStrength = 1.0f;

    // Reduce motion effects
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    bool bReduceMotion = false;

    // Screen shake intensity multiplier
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float ScreenShakeIntensity = 1.0f;

    // Visual audio cues (subtitles, indicators)
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    bool bVisualAudioCues = false;
};

/** Text accessibility settings */
USTRUCT(BlueprintType)
struct FGSDTextAccessibilitySettings
{
    GENERATED_BODY();

    // Text scale multiplier
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float TextScale = 1.0f;

    // Minimum text scale
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float MinTextScale = 0.5f;

    // Maximum text scale
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float MaxTextScale = 2.0f;

    // Always show subtitles
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    bool bAlwaysShowSubtitles = false;

    // Subtitle background opacity
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float SubtitleBackgroundOpacity = 0.75f;

    // Subtitle text size multiplier
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float SubtitleTextScale = 1.0f;
};

/** Interaction accessibility settings */
USTRUCT(BlueprintType)
struct FGSDInteractionAccessibilitySettings
{
    GENERATED_BODY();

    // Auto-aim assist strength
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float AutoAimStrength = 0.0f;

    // Hold time for hold-to-confirm actions
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float HoldTime = 0.5f;

    // Single press alternative for double press
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    bool bSinglePressAlternative = false;

    // Input repeat delay
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float InputRepeatDelay = 0.5f;

    // Input repeat rate
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
    float InputRepeatRate = 0.1f;
};

/**
 * Accessibility configuration for the GSD Platform.
 * Configure in editor, apply at runtime.
 */
UCLASS(BlueprintType, Config=Game, DefaultConfig)
class GSD_CORE_API UGSDAccessibilityConfig : public UDataAsset
{
    GENERATED_BODY()

public:
    // Visual settings
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "Visual")
    FGSDVisualAccessibilitySettings VisualSettings;

    // Text settings
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "Text")
    FGSDTextAccessibilitySettings TextSettings;

    // Interaction settings
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "Interaction")
    FGSDInteractionAccessibilitySettings InteractionSettings;

    // Apply settings on load
    UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category = "General")
    bool bApplyOnLoad = true;

    // Save settings to config
    UFUNCTION(BlueprintCallable, Category = "Accessibility")
    void SaveToConfig();

    // Load settings from config
    UFUNCTION(BlueprintCallable, Category = "Accessibility")
    void LoadFromConfig();

protected:
    virtual void PostLoad() override;
};
```

**GSDAccessibilityConfig.cpp:**
```cpp
#include "DataAssets/GSDAccessibilityConfig.h"

void UGSDAccessibilityConfig::PostLoad()
{
    Super::PostLoad();

    if (bApplyOnLoad)
    {
        LoadFromConfig();
    }
}

void UGSDAccessibilityConfig::SaveToConfig()
{
    // Save to GConfig for persistence
    // This allows settings to persist across sessions
}

void UGSDAccessibilityConfig::LoadFromConfig()
{
    // Load from GConfig
    // This restores user preferences
}
```
  </action>
  <verify>
    ```bash
    [ -f "Plugins/GSD_Core/Source/GSD_Core/Public/DataAssets/GSDAccessibilityConfig.h" ] && echo "✓ GSDAccessibilityConfig.h created"
    [ -f "Plugins/GSD_Core/Source/GSD_Core/Private/DataAssets/GSDAccessibilityConfig.cpp" ] && echo "✓ GSDAccessibilityConfig.cpp created"
    ```
  </verify>
  <done>
    - Accessibility config DataAsset created
    - Visual settings structure
    - Text settings structure
    - Interaction settings structure
  </done>
</task>

<task type="auto">
  <name>Task 2: Create GSDAccessibilityManager Subsystem</name>
  <files>
    Plugins/GSD_Core/Source/GSD_Core/Public/Subsystems/GSDAccessibilityManager.h
    Plugins/GSD_Core/Source/GSD_Core/Private/Subsystems/GSDAccessibilityManager.cpp
  </files>
  <action>
Create subsystem to manage and apply accessibility settings.

**GSDAccessibilityManager.h:**
```cpp
#pragma once

#include "CoreMinimal.h"
#include "Subsystems/EngineSubsystem.h"
#include "DataAssets/GSDAccessibilityConfig.h"
#include "GSDAccessibilityManager.generated.h"

DECLARE_DYNAMIC_MULTICAST_DELEGATE(FOnAccessibilitySettingsChanged);

/**
 * Accessibility manager subsystem.
 * Applies accessibility settings globally and notifies listeners.
 */
UCLASS()
class GSD_CORE_API UGSDAccessibilityManager : public UEngineSubsystem
{
    GENERATED_BODY()

public:
    virtual void Initialize(FSubsystemCollectionBase& Collection) override;
    virtual void Deinitialize() override;

    // Set active configuration
    UFUNCTION(BlueprintCallable, Category = "Accessibility")
    void SetConfig(UGSDAccessibilityConfig* InConfig);

    // Get current configuration
    UFUNCTION(BlueprintPure, Category = "Accessibility")
    UGSDAccessibilityConfig* GetConfig() const { return CurrentConfig; }

    // Apply settings to game
    UFUNCTION(BlueprintCallable, Category = "Accessibility")
    void ApplySettings();

    // Apply color blind correction to a color
    UFUNCTION(BlueprintPure, Category = "Accessibility")
    FLinearColor ApplyColorBlindCorrection(const FLinearColor& InColor) const;

    // Get scaled text size
    UFUNCTION(BlueprintPure, Category = "Accessibility")
    float GetScaledTextSize(float BaseSize) const;

    // Check if high contrast mode is enabled
    UFUNCTION(BlueprintPure, Category = "Accessibility")
    bool IsHighContrastMode() const;

    // Check if reduced motion is enabled
    UFUNCTION(BlueprintPure, Category = "Accessibility")
    bool IsReducedMotion() const;

    // Check if visual audio cues are enabled
    UFUNCTION(BlueprintPure, Category = "Accessibility")
    bool HasVisualAudioCues() const;

    // Delegate for settings changes
    UPROPERTY(BlueprintAssignable, Category = "Accessibility")
    FOnAccessibilitySettingsChanged OnSettingsChanged;

protected:
    // Current configuration
    UPROPERTY()
    UGSDAccessibilityConfig* CurrentConfig = nullptr;

    // Apply color blind correction based on type
    FLinearColor ApplyDeuteranopeCorrection(const FLinearColor& Color) const;
    FLinearColor ApplyProtanopeCorrection(const FLinearColor& Color) const;
    FLinearColor ApplyTritanopeCorrection(const FLinearColor& Color) const;
    FLinearColor ApplyAchromatopeCorrection(const FLinearColor& Color) const;
};
```

**Key Implementation:**
```cpp
#include "Subsystems/GSDAccessibilityManager.h"

void UGSDAccessibilityManager::Initialize(FSubsystemCollectionBase& Collection)
{
    Super::Initialize(Collection);

    // Load default config
    // Would typically load from saved user preferences
}

void UGSDAccessibilityManager::ApplySettings()
{
    if (!CurrentConfig)
    {
        return;
    }

    // Apply text scaling
    if (UUserWidget::GetDefaultTextScale() != CurrentConfig->TextSettings.TextScale)
    {
        // This would require custom text scaling implementation
    }

    // Apply screen shake settings
    // Configure in game settings

    // Broadcast change
    OnSettingsChanged.Broadcast();
}

FLinearColor UGSDAccessibilityManager::ApplyColorBlindCorrection(const FLinearColor& InColor) const
{
    if (!CurrentConfig || CurrentConfig->VisualSettings.ColorBlindType == EGSDColorBlindType::None)
    {
        return InColor;
    }

    FLinearColor CorrectedColor;

    switch (CurrentConfig->VisualSettings.ColorBlindType)
    {
    case EGSDColorBlindType::Deuteranope:
        CorrectedColor = ApplyDeuteranopeCorrection(InColor);
        break;
    case EGSDColorBlindType::Protanope:
        CorrectedColor = ApplyProtanopeCorrection(InColor);
        break;
    case EGSDColorBlindType::Tritanope:
        CorrectedColor = ApplyTritanopeCorrection(InColor);
        break;
    case EGSDColorBlindType::Achromatope:
        CorrectedColor = ApplyAchromatopeCorrection(InColor);
        break;
    default:
        CorrectedColor = InColor;
    }

    // Interpolate based on strength
    return FMath::Lerp(InColor, CorrectedColor, CurrentConfig->VisualSettings.ColorBlindStrength);
}

FLinearColor UGSDAccessibilityManager::ApplyDeuteranopeCorrection(const FLinearColor& Color) const
{
    // Simplified deuteranopia correction
    // Real implementation would use proper color matrix
    float L = 0.31399022f * Color.R + 0.63951294f * Color.G + 0.04649755f * Color.B;
    float M = 0.15537241f * Color.R + 0.75789446f * Color.G + 0.08670142f * Color.B;

    // Simulate deuteranopia
    float R = L + M * 0.0f;
    float G = L * 0.49420696f + M * 1.41296548f;
    float B = L * 0.0f + M * 0.0f + Color.B;

    return FLinearColor(FMath::Clamp(R, 0.0f, 1.0f),
                        FMath::Clamp(G, 0.0f, 1.0f),
                        FMath::Clamp(B, 0.0f, 1.0f),
                        Color.A);
}

float UGSDAccessibilityManager::GetScaledTextSize(float BaseSize) const
{
    if (!CurrentConfig)
    {
        return BaseSize;
    }

    float Scale = FMath::Clamp(CurrentConfig->TextSettings.TextScale,
                               CurrentConfig->TextSettings.MinTextScale,
                               CurrentConfig->TextSettings.MaxTextScale);

    return BaseSize * Scale;
}

bool UGSDAccessibilityManager::IsHighContrastMode() const
{
    return CurrentConfig && CurrentConfig->VisualSettings.bHighContrastMode;
}

bool UGSDAccessibilityManager::IsReducedMotion() const
{
    return CurrentConfig && CurrentConfig->VisualSettings.bReduceMotion;
}
```
  </action>
  <verify>
    ```bash
    [ -f "Plugins/GSD_Core/Source/GSD_Core/Public/Subsystems/GSDAccessibilityManager.h" ] && echo "✓ GSDAccessibilityManager.h created"
    [ -f "Plugins/GSD_Core/Source/GSD_Core/Private/Subsystems/GSDAccessibilityManager.cpp" ] && echo "✓ GSDAccessibilityManager.cpp created"
    ```
  </verify>
  <done>
    - Accessibility manager subsystem created
    - Color blind correction implemented
    - Text scaling helper
    - Settings change delegate
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Accessibility Blueprint Library</name>
  <files>
    Plugins/GSD_Core/Source/GSD_Core/Public/Blueprint/GSDAccessibilityLibrary.h
    Plugins/GSD_Core/Source/GSD_Core/Private/Blueprint/GSDAccessibilityLibrary.cpp
  </files>
  <action>
Create blueprint library for accessibility helpers.

**GSDAccessibilityLibrary.h:**
```cpp
#pragma once

#include "CoreMinimal.h"
#include "Kismet/BlueprintFunctionLibrary.h"
#include "GSDAccessibilityLibrary.generated.h"

class UGSDAccessibilityManager;
class UMaterialInstanceDynamic;

/**
 * Blueprint library for accessibility functions.
 */
UCLASS()
class GSD_CORE_API UGSDAccessibilityLibrary : public UBlueprintFunctionLibrary
{
    GENERATED_BODY()

public:
    // Get accessibility manager
    UFUNCTION(BlueprintPure, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static UGSDAccessibilityManager* GetAccessibilityManager(UObject* WorldContextObject);

    // Apply color blind correction to a color
    UFUNCTION(BlueprintPure, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static FLinearColor CorrectColorForColorBlindness(UObject* WorldContextObject, const FLinearColor& InColor);

    // Get scaled text size
    UFUNCTION(BlueprintPure, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static float GetScaledTextSize(UObject* WorldContextObject, float BaseSize);

    // Check if high contrast mode is enabled
    UFUNCTION(BlueprintPure, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static bool IsHighContrastModeEnabled(UObject* WorldContextObject);

    // Check if reduced motion is enabled
    UFUNCTION(BlueprintPure, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static bool IsReducedMotionEnabled(UObject* WorldContextObject);

    // Check if visual audio cues are enabled
    UFUNCTION(BlueprintPure, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static bool AreVisualAudioCuesEnabled(UObject* WorldContextObject);

    // Apply accessibility settings to a material
    UFUNCTION(BlueprintCallable, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static void ApplyAccessibilityToMaterial(UObject* WorldContextObject, UMaterialInstanceDynamic* Material);

    // Get recommended subtitle background color
    UFUNCTION(BlueprintPure, Category = "Accessibility", meta = (WorldContext = "WorldContextObject"))
    static FLinearColor GetSubtitleBackgroundColor(UObject* WorldContextObject);
};
```
  </action>
  <verify>
    ```bash
    [ -f "Plugins/GSD_Core/Source/GSD_Core/Public/Blueprint/GSDAccessibilityLibrary.h" ] && echo "✓ GSDAccessibilityLibrary.h created"
    [ -f "Plugins/GSD_Core/Source/GSD_Core/Private/Blueprint/GSDAccessibilityLibrary.cpp" ] && echo "✓ GSDAccessibilityLibrary.cpp created"
    ```
  </verify>
  <done>
    - Blueprint library created
    - Helper functions for accessibility
    - Material integration support
  </done>
</task>

<task type="auto">
  <name>Task 4: Create Accessibility Documentation</name>
  <files>
    Plugins/GSD_Core/Docs/AccessibilitySystem.md
  </files>
  <action>
Create documentation for accessibility system.

**Content:**
```markdown
# GSD Accessibility System

## Overview
The GSD Platform includes comprehensive accessibility support for visual, text, and interaction accommodations.

## Features

### Visual Accessibility
- **High Contrast Mode**: Increases contrast for better visibility
- **Color Blind Correction**: Supports 4 types of color blindness
  - Deuteranopia (Red-Green)
  - Protanopia (Red-Green)
  - Tritanopia (Blue-Yellow)
  - Achromatopsia (Monochrome)
- **Reduce Motion**: Minimizes motion effects and screen shake
- **Visual Audio Cues**: Subtitles and visual indicators for audio

### Text Accessibility
- **Text Scaling**: Adjustable from 0.5x to 2.0x
- **Always Show Subtitles**: Force subtitles on
- **Subtitle Background**: Adjustable opacity

### Interaction Accessibility
- **Auto-Aim Assist**: Configurable aim assistance
- **Hold Time**: Adjustable hold-to-confirm duration
- **Single Press Alternative**: Alternative to double-press actions

## Usage

### In Blueprints
```cpp
// Get scaled text size
float ScaledSize = UGSDAccessibilityLibrary::GetScaledTextSize(this, 24.0f);

// Correct color for color blindness
FLinearColor CorrectedColor = UGSDAccessibilityLibrary::CorrectColorForColorBlindness(this, OriginalColor);

// Check settings
if (UGSDAccessibilityLibrary::IsHighContrastModeEnabled(this))
{
    // Use high contrast colors
}
```

### In C++
```cpp
#include "Subsystems/GSDAccessibilityManager.h"

UGSDAccessibilityManager* Manager = GetGameInstance()->GetSubsystem<UGSDAccessibilityManager>();
float ScaledSize = Manager->GetScaledTextSize(24.0f);
FLinearColor Corrected = Manager->ApplyColorBlindCorrection(OriginalColor);
```

## Configuration
1. Create UGSDAccessibilityConfig DataAsset
2. Configure settings in editor
3. Assign to AccessibilityManager at runtime
4. Settings persist via config file
```
  </action>
  <verify>
    ```bash
    [ -f "Plugins/GSD_Core/Docs/AccessibilitySystem.md" ] && echo "✓ Accessibility documentation created"
    ```
  </verify>
  <done>
    - Features documented
    - Usage examples provided
    - Configuration guide included
  </done>
</task>

</tasks>

<verification>
1. Accessibility config DataAsset created
2. Accessibility manager subsystem created
3. Color blind correction implemented
4. Text scaling helper implemented
5. Blueprint library created
6. Documentation created
</verification>

<success_criteria>
- Accessibility configuration DataAsset exists
- Manager subsystem applies settings
- Color blind correction for 4 types
- Text scaling from 0.5x to 2.0x
- High contrast mode support
- Reduced motion support
- Visual audio cues support
- Blueprint-accessible functions
</success_criteria>

<output>
After completion, create `.planning/phases/12-production-enhancements/12-08-SUMMARY.md`
</output>
