---
phase: 02.5-charlotte-map-data
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - tools/charlotte_map_acquisition/__init__.py
  - tools/charlotte_map_acquisition/config/__init__.py
  - tools/charlotte_map_acquisition/config/charlotte_bounds.json
  - tools/charlotte_map_acquisition/config/zoom_levels.json
  - tools/charlotte_map_acquisition/coordinates.py
  - tools/charlotte_map_acquisition/requirements.txt
  - tools/charlotte_map_acquisition/README.md
autonomous: true

must_haves:
  truths:
    - "Python package structure exists with proper __init__.py files"
    - "Configuration files contain Charlotte I-485 bounding box coordinates"
    - "Coordinate module transforms WGS84 to UTM Zone 17N to Unreal centimeters"
    - "Requirements file lists all GIS dependencies with versions"
  artifacts:
    - path: "tools/charlotte_map_acquisition/coordinates.py"
      provides: "Coordinate transformation pipeline"
      contains: "def create_coordinate_pipeline"
      min_lines: 50
    - path: "tools/charlotte_map_acquisition/config/charlotte_bounds.json"
      provides: "I-485 bounding box definition"
      contains: "north"
    - path: "tools/charlotte_map_acquisition/requirements.txt"
      provides: "Python dependencies"
      contains: "pyproj"
  key_links:
    - from: "coordinates.py"
      to: "config/charlotte_bounds.json"
      via: "import json, load bounds"
      pattern: "charlotte_bounds.json"
---

<objective>
Create the Python package foundation for Charlotte map data acquisition, including project structure, configuration files, and the core coordinate transformation module.

Purpose: Establish the foundational infrastructure that all pipeline scripts will depend on - configuration management and coordinate system transformations.
Output: A Python package with config files defining Charlotte I-485 bounds and a coordinate module handling WGS84 -> UTM Zone 17N -> Unreal centimeters transformations.
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.5-charlotte-map-data/02.5-RESEARCH.md

# Research provides:
# - Standard stack: GDAL, PyProj, OSMnx, requests, GeoPandas, Shapely, Pillow, Rasterio
# - Charlotte I-485 bounds: North 35.37, South 35.08, East -80.65, West -81.00
# - UTM Zone: 17N (EPSG:32617)
# - Coordinate pipeline pattern with origin offset calculation
# - Unreal uses centimeters, GIS uses meters (multiply by 100)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Package Structure and Configuration</name>
  <files>
    tools/charlotte_map_acquisition/__init__.py
    tools/charlotte_map_acquisition/config/__init__.py
    tools/charlotte_map_acquisition/config/charlotte_bounds.json
    tools/charlotte_map_acquisition/config/zoom_levels.json
    tools/charlotte_map_acquisition/requirements.txt
    tools/charlotte_map_acquisition/README.md
  </files>
  <action>
Create the Python package structure under tools/charlotte_map_acquisition/:

1. Create __init__.py files for the package and config submodule (can be empty or have version info)

2. Create config/charlotte_bounds.json with Charlotte I-485 bounding box:
```json
{
  "name": "Charlotte I-485 Corridor",
  "north": 35.37,
  "south": 35.08,
  "east": -80.65,
  "west": -81.00,
  "center_lat": 35.227,
  "center_lon": -80.843,
  "utm_zone": "17N",
  "utm_epsg": 32617,
  "loop_length_miles": 66.68,
  "notes": "I-485 complete loop around Charlotte, NC"
}
```

3. Create config/zoom_levels.json with tile zoom configurations:
```json
{
  "development": [15, 16],
  "production": [17],
  "high_quality": [18],
  "tile_size_meters": {
    "15": 4800,
    "16": 2400,
    "17": 1200,
    "18": 600
  },
  "estimated_tiles": {
    "15": 400,
    "16": 1600,
    "17": 6400,
    "18": 25600
  }
}
```

4. Create requirements.txt with GIS dependencies (use versions from research):
```
# Core GIS
gdal>=3.9.0
pyproj>=3.6.0
osmnx>=1.9.0
geopandas>=0.14.0
shapely>=2.0.0
rasterio>=1.3.0

# Utilities
requests>=2.31.0
Pillow>=10.0.0
numpy>=1.26.0
```

5. Create README.md with:
- Project overview (Charlotte map data acquisition for Unreal Engine)
- Installation instructions (pip install -r requirements.txt)
- Quick start guide
- Link to research document for details

DO NOT create the scripts/ or data/ directories yet - those come in subsequent plans.
  </action>
  <verify>
ls -la tools/charlotte_map_acquisition/
ls -la tools/charlotte_map_acquisition/config/
cat tools/charlotte_map_acquisition/config/charlotte_bounds.json
cat tools/charlotte_map_acquisition/requirements.txt
  </verify>
  <done>
Package structure exists with config files containing correct Charlotte I-485 bounds and requirements.txt listing all GIS dependencies.
</done>
</task>

<task type="auto">
  <name>Task 2: Create Coordinate Transformation Module</name>
  <files>
    tools/charlotte_map_acquisition/coordinates.py
  </files>
  <action>
Create the core coordinate transformation module at tools/charlotte_map_acquisition/coordinates.py.

This module provides the coordinate pipeline that all other scripts will use. Based on the research pattern:

1. Import pyproj for coordinate transformations
2. Load bounds from config/charlotte_bounds.json
3. Create a coordinate transformation function that:
   - Takes WGS84 (lat/lon) coordinates
   - Transforms to UTM Zone 17N (EPSG:32617)
   - Applies origin offset (center of I-485 bounds becomes Unreal 0,0,0)
   - Converts meters to Unreal centimeters (* 100)
   - Returns (unreal_x, unreal_y, unreal_z) where X=North, Y=East, Z=Up

4. Include helper functions:
   - latlon_to_tile(lat, lon, zoom) - converts lat/lon to XYZ tile coordinates
   - get_tile_bounds(bounds, zoom) - returns tile coordinate range for a bounding box
   - validate_coordinates(lat, lon) - checks if coords are within Charlotte bounds

5. Add docstrings explaining:
   - Coordinate system flow: WGS84 -> UTM17N -> Unreal
   - Why UTM Zone 17N (Charlotte location)
   - Unreal axis conventions (X=North, Y=East, Z=Up)

Key implementation details from research:
- Use CRS.from_epsg(4326) for WGS84
- Use CRS.from_epsg(32617) for UTM Zone 17N
- Use Transformer.from_crs() with always_xy=True
- Origin offset: calculate from center_lat/center_lon in config
  </action>
  <verify>
python3 -c "from tools.charlotte_map_acquisition.coordinates import create_coordinate_pipeline, latlon_to_tile; print('Imports OK')"
python3 -c "from tools.charlotte_map_acquisition.coordinates import create_coordinate_pipeline; to_unreal = create_coordinate_pipeline(35.227, -80.843); print(to_unreal(-80.843, 35.227, 0))"
  </verify>
  <done>
Coordinate module imports successfully and provides WGS84->UTM17N->Unreal transformation pipeline. Origin point (center of bounds) transforms to (0, 0, 0) in Unreal coordinates.
</done>
</task>

</tasks>

<verification>
1. Package structure exists with __init__.py files
2. Configuration files contain correct Charlotte bounds and zoom levels
3. Requirements.txt includes all GIS dependencies
4. Coordinate module imports without errors
5. Coordinate transformation returns correct values for known points
6. README documents installation and usage
</verification>

<success_criteria>
- Python package structure created under tools/charlotte_map_acquisition/
- Configuration files define Charlotte I-485 bounds (35.37N, 35.08S, -80.65E, -81.00W)
- Coordinate module transforms WGS84 to UTM Zone 17N to Unreal centimeters
- Requirements file lists: pyproj, osmnx, geopandas, shapely, rasterio, requests, Pillow, numpy
- All files committed to git
</success_criteria>

<output>
After completion, create `.planning/phases/02.5-charlotte-map-data/02.5-01-SUMMARY.md`
</output>
