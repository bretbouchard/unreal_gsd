---
phase: 02-world-partition-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Plugins/GSD_CityStreaming/GSD_CityStreaming.uplugin
  - Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/GSD_CityStreaming.Build.cs
  - Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Public/GSDCityStreamingSettings.h
  - Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Private/GSDCityStreamingSettings.cpp
  - Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Private/GSD_CityStreaming.cpp
autonomous: true
user_setup: []

must_haves:
  truths:
    - "GSD_CityStreaming plugin loads in Unreal Editor"
    - "City streaming settings appear in Project Settings under GSD category"
    - "Settings define grid cell size (25600 UU) and loading range (76800 UU)"
  artifacts:
    - path: "Plugins/GSD_CityStreaming/GSD_CityStreaming.uplugin"
      provides: "Plugin manifest with correct loading phase"
      contains: "LoadingPhase"
    - path: "Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Public/GSDCityStreamingSettings.h"
      provides: "World Partition configuration settings"
      exports: ["UGSDCityStreamingSettings"]
  key_links:
    - from: "GSDCityStreamingSettings"
      to: "Project Settings"
      via: "UDeveloperSettings"
      pattern: "UDeveloperSettings"
---

<objective>
Create GSD_CityStreaming plugin with World Partition configuration settings for Charlotte city streaming.

Purpose: Establish the plugin infrastructure and centralized settings for World Partition grid configuration, enabling consistent streaming behavior across all city levels.
Output: Working GSD_CityStreaming plugin with DeveloperSettings for World Partition configuration.
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-world-partition-setup/02-RESEARCH.md

# Prior phase context
@.planning/phases/01-plugin-architecture-foundation/01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GSD_CityStreaming Plugin Structure</name>
  <files>
    Plugins/GSD_CityStreaming/GSD_CityStreaming.uplugin
    Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/GSD_CityStreaming.Build.cs
    Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Private/GSD_CityStreaming.cpp
    Plugins/GSD_CityStreaming/Resources/Icon128.png
  </files>
  <action>
    Create the GSD_CityStreaming plugin following the established GSD_Core pattern:

    1. Create plugin directory structure:
       - Plugins/GSD_CityStreaming/
       - Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Public/
       - Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Private/
       - Plugins/GSD_CityStreaming/Resources/

    2. Create GSD_CityStreaming.uplugin with:
       - Name: GSD_CityStreaming
       - Version: 1.0.0
       - LoadingPhase: PreDefault (same as GSD_Core to ensure early loading)
       - Modules: [{Name: GSD_CityStreaming, Type: Runtime}]

    3. Create GSD_CityStreaming.Build.cs with dependencies:
       - Core, CoreUObject, Engine, InputCore
       - GSD_Core (for shared interfaces and logging)
       - WorldPartition (for streaming support)

    4. Create GSD_CityStreaming.cpp module implementation with:
       - StartupModule/ShutdownModule logging using GSD_LOG macros
       - Include GSDLog.h from GSD_Core

    5. Create placeholder Icon128.png (copy from GSD_Core if exists, or create minimal placeholder)

    Use the same patterns established in Phase 1 Plan 01 (GSD_Core structure).
  </action>
  <verify>
    Check that all plugin files exist and Build.cs has correct dependencies:
    - ls Plugins/GSD_CityStreaming/GSD_CityStreaming.uplugin
    - grep -c "GSD_Core" Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/GSD_CityStreaming.Build.cs
  </verify>
  <done>
    GSD_CityStreaming plugin directory structure exists with PreDefault loading phase and GSD_Core dependency.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement City Streaming Settings</name>
  <files>
    Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Public/GSDCityStreamingSettings.h
    Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Private/GSDCityStreamingSettings.cpp
  </files>
  <action>
    Create UGSDCityStreamingSettings as UDeveloperSettings for Project Settings integration:

    1. In GSDCityStreamingSettings.h, create class inheriting from UDeveloperSettings:
       - Use Config=Game, DefaultConfig meta
       - Category: "GSD City Streaming"

    2. Add World Partition Grid settings:
       - DefaultGridCellSize (int32, default 25600) - 256m cells for urban density
       - DefaultLoadingRange (int32, default 76800) - 768m radius for smooth driving
       - ClampMin/ClampMax meta for validation

    3. Add HLOD settings:
       - bAutoGenerateHLODs (bool, default true)
       - HLODTierCount (int32, default 3)
       - HLODBuildPath (FString, default "/Game/HLOD")

    4. Add Import settings:
       - bAutoGenerateCollision (bool, default true)
       - ImportScale (float, default 1.0f)
       - PreferredImportFormat (FString, default "USD")

    5. Add static Get() method for singleton access

    6. In GSDCityStreamingSettings.cpp:
       - Implement Get() method using GetDefault<UGSDCityStreamingSettings>()
       - No additional logic needed - settings are config-driven

    Reference the code example from RESEARCH.md for the exact structure.
  </action>
  <verify>
    Verify settings class compiles and appears in Project Settings:
    - grep -c "UGSDCityStreamingSettings" Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Public/GSDCityStreamingSettings.h
    - grep -c "DefaultGridCellSize" Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Public/GSDCityStreamingSettings.h
  </verify>
  <done>
    City streaming settings class exists with grid cell size (25600), loading range (76800), HLOD, and import configuration.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify Plugin Loads in Editor</name>
  <files>
    Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Private/GSD_CityStreaming.cpp
  </files>
  <action>
    Ensure the plugin module implementation correctly logs startup:

    1. Update GSD_CityStreaming.cpp to include logging on StartupModule:
       - GSD_LOG(TEXT("GSD_CityStreaming module started"))
       - Log the configured grid cell size from settings

    2. Verify module shutdown logs correctly

    3. Add comment indicating this plugin provides World Partition configuration for Charlotte city streaming

    The logging confirms the plugin loads in the correct phase (PreDefault) and can access settings.
  </action>
  <verify>
    Verify module implementation has proper logging:
    - grep -c "GSD_LOG" Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/Private/GSD_CityStreaming.cpp
  </verify>
  <done>
    Plugin module implementation logs startup with settings confirmation.
  </done>
</task>

</tasks>

<verification>
1. GSD_CityStreaming.uplugin exists with PreDefault loading phase
2. GSD_CityStreaming.Build.cs has GSD_Core and WorldPartition dependencies
3. UGSDCityStreamingSettings class exists with grid configuration
4. Settings default to 25600 UU cell size and 76800 UU loading range
5. Plugin module implementation compiles and logs startup
</verification>

<success_criteria>
- GSD_CityStreaming plugin structure complete
- City streaming settings accessible via Project Settings > GSD City Streaming
- Grid cell size defaults to 25600 UU (256m) for urban density
- Loading range defaults to 76800 UU (768m) for driving gameplay
- Plugin depends on GSD_Core for shared infrastructure
</success_criteria>

<output>
After completion, create `.planning/phases/02-world-partition-setup/02-01-SUMMARY.md`
</output>
