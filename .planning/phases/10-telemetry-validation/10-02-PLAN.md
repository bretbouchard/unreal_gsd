---
phase: 10-telemetry-validation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - Plugins/GSD_ValidationTools/GSD_ValidationTools.uplugin
  - Plugins/GSD_ValidationTools/Resources/Icon128.png
  - Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/GSD_ValidationTools.Build.cs
  - Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Private/GSD_ValidationTools.cpp
  - Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/GSD_ValidationTools.h
  - Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/GSDValidationLog.h
  - Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/Types/GSDValidationTypes.h
autonomous: true
must_haves:
  truths:
    - "GSD_ValidationTools plugin compiles and loads in Unreal Editor"
    - "Log category LogGSDValidation is accessible for logging"
    - "Validation types (FGSDAssetBudget, FGSDValidationResult) are defined"
    - "Asset budget configuration structure exists"
  artifacts:
    - path: "Plugins/GSD_ValidationTools/GSD_ValidationTools.uplugin"
      provides: "Plugin manifest"
      contains: "Name=GSD_ValidationTools"
    - path: "Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/GSDValidationLog.h"
      provides: "Log category declaration"
      contains: "DECLARE_LOG_CATEGORY_EXTERN"
    - path: "Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/Types/GSDValidationTypes.h"
      provides: "Validation data structures"
      contains: "USTRUCT(BlueprintType)"
  key_links:
    - from: "GSDValidationLog.h"
      to: "GSD_ValidationTools.cpp"
      via: "DEFINE_LOG_CATEGORY"
      pattern: "DEFINE_LOG_CATEGORY\\(LogGSDValidation\\)"
---

<objective>
Create GSD_ValidationTools plugin foundation with validation infrastructure and budget configuration types.

Purpose: Establish the validation tools plugin that provides commandlets, editor utilities, and asset budget enforcement for CI/CD pipelines.
Output: Compiled plugin with log category, validation types, and budget configuration structures.
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-telemetry-validation/10-RESEARCH.md

# Reference existing plugin patterns
@Plugins/GSD_Vehicles/Source/GSD_Vehicles/GSD_Vehicles.Build.cs
@Plugins/GSD_Vehicles/Source/GSD_Vehicles/Public/GSDVehiclesLog.h
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GSD_ValidationTools Plugin Structure</name>
  <files>
    Plugins/GSD_ValidationTools/GSD_ValidationTools.uplugin
    Plugins/GSD_ValidationTools/Resources/Icon128.png
    Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/GSD_ValidationTools.Build.cs
    Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Private/GSD_ValidationTools.cpp
    Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/GSD_ValidationTools.h
  </files>
  <action>
Create the GSD_ValidationTools plugin structure following the established pattern from GSD_Vehicles and GSD_Crowds plugins.

**Plugin Manifest (GSD_ValidationTools.uplugin):**
```json
{
  "FileVersion": 3,
  "Version": 1,
  "VersionName": "1.0",
  "FriendlyName": "GSD Validation Tools",
  "Description": "Editor utilities, commandlets, and asset budget enforcement for GSD Platform validation",
  "Category": "GSD",
  "CreatedBy": "Bret Bouchard",
  "CreatedByURL": "",
  "DocsURL": "",
  "MarketplaceURL": "",
  "SupportURL": "",
  "CanContainContent": false,
  "IsBetaVersion": false,
  "IsExperimentalVersion": false,
  "Installed": false,
  "Modules": [
    {
      "Name": "GSD_ValidationTools",
      "Type": "Editor",
      "LoadingPhase": "Default"
    }
  ]
}
```

**Build.cs Dependencies:**
```csharp
PublicDependencyModuleNames.AddRange(new string[] {
    "Core", "CoreUObject", "Engine", "Json", "JsonUtilities",
    "EditorScriptingUtilities", "Blutility", "UMG", "UMGEditor"
});

PrivateDependencyModuleNames.AddRange(new string[] {
    "GSD_Core", "GSD_Telemetry"
});
```

**Module Class (GSD_ValidationTools.h):**
```cpp
class GSD_VALIDATIONTOOLS_API FGSD_ValidationToolsModule : public IModuleInterface
{
public:
    virtual void StartupModule() override;
    virtual void ShutdownModule() override;
};
```

**Module Implementation (GSD_ValidationTools.cpp):**
```cpp
#include "GSD_ValidationTools.h"
#include "GSDValidationLog.h"

#define LOCTEXT_NAMESPACE "FGSD_ValidationToolsModule"

void FGSD_ValidationToolsModule::StartupModule()
{
    GSDVALIDATION_LOG(Log, TEXT("GSD_ValidationTools module starting up..."));
}

void FGSD_ValidationToolsModule::ShutdownModule()
{
    GSDVALIDATION_LOG(Log, TEXT("GSD_ValidationTools module shutting down..."));
}

#undef LOCTEXT_NAMESPACE

IMPLEMENT_MODULE(FGSD_ValidationToolsModule, GSD_ValidationTools)
```

**Important:**
- Use "Editor" module type (validation tools are editor-only)
- Include EditorScriptingUtilities, Blutility, UMG, UMGEditor for editor widgets
- Include GSD_Core and GSD_Telemetry in private dependencies
- Set LoadingPhase to "Default"
- Create empty 128x128 PNG for Icon128.png (placeholder)
</action>
  <verify>
    ```bash
    # Verify plugin structure exists
    test -f Plugins/GSD_ValidationTools/GSD_ValidationTools.uplugin && echo "Plugin manifest exists" || echo "ERROR: Plugin manifest missing"

    # Verify Build.cs
    test -f Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/GSD_ValidationTools.Build.cs && echo "Build.cs exists" || echo "ERROR: Build.cs missing"

    # Verify module files
    test -f Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/GSD_ValidationTools.h && echo "Header exists" || echo "ERROR: Header missing"
    test -f Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Private/GSD_ValidationTools.cpp && echo "Implementation exists" || echo "ERROR: Implementation missing"

    # Verify editor module type
    grep -q '"Type": "Editor"' Plugins/GSD_ValidationTools/GSD_ValidationTools.uplugin && echo "Editor module type set" || echo "ERROR: Module type not Editor"
    ```
  </verify>
  <done>
Plugin structure created with:
- GSD_ValidationTools.uplugin manifest with Editor module type
- GSD_ValidationTools.Build.cs with editor dependencies (EditorScriptingUtilities, Blutility, UMG, UMGEditor)
- Module class FGSD_ValidationToolsModule with startup/shutdown logging
- All required directories and placeholder icon
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Validation Logging and Types</name>
  <files>
    Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/GSDValidationLog.h
    Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/Types/GSDValidationTypes.h
  </files>
  <action>
Create log category and validation data structures for asset budgets and validation results.

**GSDValidationLog.h:**
```cpp
#pragma once

#include "CoreMinimal.h"

GSD_VALIDATIONTOOLS_API DECLARE_LOG_CATEGORY_EXTERN(LogGSDValidation, Log, All);

// Convenience macros for validation logging
#define GSDVALIDATION_LOG(Verbosity, Format, ...) \
    UE_LOG(LogGSDValidation, Verbosity, Format, ##__VA_ARGS__)

#define GSDVALIDATION_WARN(Format, ...) \
    UE_LOG(LogGSDValidation, Warning, Format, ##__VA_ARGS__)

#define GSDVALIDATION_ERROR(Format, ...) \
    UE_LOG(LogGSDValidation, Error, Format, ##__VA_ARGS__)

#define GSDVALIDATION_VERBOSE(Format, ...) \
    UE_LOG(LogGSDValidation, Verbose, Format, ##__VA_ARGS__)
```

**GSDValidationTypes.h:**
```cpp
#pragma once

#include "CoreMinimal.h"
#include "GSDValidationTypes.generated.h"

/**
 * Asset budget configuration for a single asset type
 */
USTRUCT(BlueprintType)
struct FGSDAssetBudget
{
    GENERATED_BODY()

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FString AssetType;  // e.g., "StaticMesh", "Texture", "SkeletalMesh"

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    float MaxSizeMB = 100.0f;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FString Description;
};

/**
 * Validation error or warning
 */
USTRUCT(BlueprintType)
struct FGSDValidationIssue
{
    GENERATED_BODY()

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FString AssetPath;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FString IssueType;  // e.g., "SizeExceeded", "MissingLOD", "InvalidConfig"

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FString Description;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    float Severity = 0.0f;  // 0.0 = warning, 1.0 = error

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FString Suggestion;  // How to fix
};

/**
 * Complete validation result for a single validation run
 */
USTRUCT(BlueprintType)
struct FGSDValidationResult
{
    GENERATED_BODY()

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    bool bPassed = true;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    int32 TotalAssetsChecked = 0;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    int32 ErrorCount = 0;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    int32 WarningCount = 0;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    TArray<FGSDValidationIssue> Issues;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    double ValidationTimeSeconds = 0.0;

    void AddError(const FString& AssetPath, const FString& IssueType,
                  const FString& Description, const FString& Suggestion = TEXT(""))
    {
        FGSDValidationIssue Issue;
        Issue.AssetPath = AssetPath;
        Issue.IssueType = IssueType;
        Issue.Description = Description;
        Issue.Severity = 1.0f;
        Issue.Suggestion = Suggestion;
        Issues.Add(Issue);
        ErrorCount++;
        bPassed = false;
    }

    void AddWarning(const FString& AssetPath, const FString& IssueType,
                    const FString& Description, const FString& Suggestion = TEXT(""))
    {
        FGSDValidationIssue Issue;
        Issue.AssetPath = AssetPath;
        Issue.IssueType = IssueType;
        Issue.Description = Description;
        Issue.Severity = 0.0f;
        Issue.Suggestion = Suggestion;
        Issues.Add(Issue);
        WarningCount++;
    }
};

/**
 * World Partition validation configuration
 */
USTRUCT(BlueprintType)
struct FGSDWorldPartitionValidationConfig
{
    GENERATED_BODY()

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    float MinCellSize = 12800.0f;  // 128m minimum

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    int32 MinHLODLayers = 3;  // Require 3 HLOD levels

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    float MaxLoadingRange = 50000.0f;  // 500m max

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    bool bRequireDataLayers = true;  // Data layers must exist
};

/**
 * Performance route waypoint for baseline capture
 */
USTRUCT(BlueprintType)
struct FGSDPerfRouteWaypoint
{
    GENERATED_BODY()

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FVector Location = FVector::ZeroVector;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    FString WaypointName;

    UPROPERTY(EditAnywhere, BlueprintReadOnly, Category = "Validation")
    float ExpectedFrameTimeMs = 16.67f;  // 60fps target
};
```

**Important:**
- FGSDValidationResult provides helper methods AddError/AddWarning
- All structs are BlueprintType for editor widget access
- FGSDAssetBudget uses float for MB size (precision)
- FGSDValidationIssue includes Suggestion field for actionable feedback
</action>
  <verify>
    ```bash
    # Verify log header exists and contains log category
    grep -q "DECLARE_LOG_CATEGORY_EXTERN.*LogGSDValidation" \
      Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/GSDValidationLog.h \
      && echo "Log category declared" || echo "ERROR: Log category not declared"

    # Verify types header contains validation result
    grep -q "USTRUCT.*FGSDValidationResult" \
      Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/Types/GSDValidationTypes.h \
      && echo "Validation result struct exists" || echo "ERROR: Validation result struct missing"

    # Verify asset budget struct
    grep -q "USTRUCT.*FGSDAssetBudget" \
      Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/Types/GSDValidationTypes.h \
      && echo "Asset budget struct exists" || echo "ERROR: Asset budget struct missing"

    # Verify helper methods exist
    grep -q "AddError.*AddWarning" \
      Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/Public/Types/GSDValidationTypes.h \
      && echo "Helper methods present" || echo "ERROR: Helper methods missing"
    ```
  </verify>
  <done>
Logging and validation types created with:
- LogGSDValidation category with convenience macros
- FGSDAssetBudget for per-asset-type budget configuration
- FGSDValidationResult with AddError/AddWarning helper methods
- FGSDValidationIssue with Severity and Suggestion fields
- FGSDWorldPartitionValidationConfig for WP validation parameters
- FGSDPerfRouteWaypoint for performance baseline waypoints
  </done>
</task>

</tasks>

<verification>
1. Plugin compiles without errors
2. Log category accessible via UE_LOG(LogGSDValidation, ...)
3. Validation types usable in C++ and Blueprints
4. FGSDValidationResult::AddError/AddWarning methods functional
</verification>

<success_criteria>
- GSD_ValidationTools plugin structure follows established pattern
- Module type is "Editor" (editor-only tools)
- Log category LogGSDValidation is functional
- Validation result struct provides error/warning aggregation
- Asset budget configuration structure supports per-type budgets
</success_criteria>

<output>
After completion, create `.planning/phases/10-telemetry-validation/10-02-SUMMARY.md`
</output>
