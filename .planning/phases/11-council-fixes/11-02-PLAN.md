---
phase: 11-council-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs
autonomous: true
must_haves:
  truths:
    - "GSD_Crowds Build.cs includes all required Mass Entity module dependencies"
    - "Plugin hot reload succeeds without missing module errors"
    - "All Mass Entity types resolve correctly"
  artifacts:
    - path: "Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs"
      provides: "Build configuration with complete dependencies"
      contains: "MassEntity, MassCommon, MassSpawner, GameplayTags"
  key_links:
    - from: "Build.cs"
      to: "UnrealBuildTool"
      via: "PublicDependencyModuleNames"
      pattern: "MassEntity|MassCommon|MassSpawner"
---

<objective>
Verify and fix all missing module dependencies in GSD_Crowds Build.cs.

Purpose: Ensure all required Mass Entity modules are properly declared to prevent missing module errors during compilation and hot reload. Council review identified missing dependencies that need to be added.

Output: Complete Build.cs with all required dependencies, successful hot reload without errors.

Council Issues: #2, #3 - Missing MassEntity and GameplayTags module dependencies (Architecture Rick, P0 Critical)
</objective>

<execution_context>
@/Users/bretbouchard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bretbouchard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-council-fixes/11-RESEARCH.md

# Reference existing Build.cs
@Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs
@Plugins/GSD_Vehicles/Source/GSD_Vehicles/GSD_Vehicles.Build.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify and Update GSD_Crowds Build.cs Dependencies</name>
  <files>
    Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs
  </files>
  <action>
Verify GSD_Crowds.Build.cs has all required module dependencies. Based on code review, ensure these modules are present:

**Required Public Dependencies:**
```csharp
PublicDependencyModuleNames.AddRange(new string[] {
    "Core",
    "CoreUObject",
    "Engine",
    "GSD_Core",              // Core interfaces
    "GSD_CityStreaming",     // World Partition integration
    "MassEntity",            // ECS framework (CRITICAL - Council #2)
    "MassRepresentation",    // LOD switching
    "MassSpawner",           // Entity spawning (CRITICAL - Council #2)
    "MassLOD",               // Distance calculations
    "MassCommon",            // Shared Mass types (CRITICAL - Council #2)
    "MassAI",                // AI behaviors and navigation
    "ZoneGraph",             // Lane navigation
    "MassMovement",          // Movement along lanes
    "StateTreeModule",       // Behavior control
    "SmartObjectsModule",    // Interaction points
    "AIModule",              // Behavior Trees, AI Perception
    "NavigationSystem",      // NavMesh for hero NPCs
    "GameplayTags"           // FGameplayTag in density modifiers (CRITICAL - Council #3)
});
```

**Current Status Check:**
The current Build.cs already has these dependencies (from Phase 6/7 work). Verify they are still present and no regressions occurred.

**If any modules are missing, add them:**
1. MassEntity - Core ECS framework
2. MassCommon - Shared types like FMassFragment
3. MassSpawner - Entity spawning system
4. GameplayTags - FGameplayTag used in event modifiers

**Verification Steps:**
1. Read current Build.cs
2. Compare against required list above
3. Add any missing modules
4. Ensure no duplicates

**Important:**
- Do NOT remove existing dependencies
- Only ADD missing ones
- Maintain alphabetical or logical ordering
- Keep Public vs Private separation correct
  </action>
  <verify>
    ```bash
    # Verify critical dependencies are present
    grep -q "MassEntity" Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs && echo "✓ MassEntity found" || echo "✗ MassEntity MISSING"
    grep -q "MassCommon" Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs && echo "✓ MassCommon found" || echo "✗ MassCommon MISSING"
    grep -q "MassSpawner" Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs && echo "✓ MassSpawner found" || echo "✗ MassSpawner MISSING"
    grep -q "GameplayTags" Plugins/GSD_Crowds/Source/GSD_Crowds/GSD_Crowds.Build.cs && echo "✓ GameplayTags found" || echo "✗ GameplayTags MISSING"

    echo "Build.cs dependency verification complete"
    ```
  </verify>
  <done>
    - GSD_Crowds.Build.cs verified/updated with all required dependencies
    - MassEntity, MassCommon, MassSpawner, GameplayTags present
    - No missing module errors during compilation
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify All Other Plugin Build.cs Files</name>
  <files>
    Plugins/GSD_Vehicles/Source/GSD_Vehicles/GSD_Vehicles.Build.cs
    Plugins/GSD_Telemetry/Source/GSD_Telemetry/GSD_Telemetry.Build.cs
    Plugins/GSD_ValidationTools/Source/GSD_ValidationTools/GSD_ValidationTools.Build.cs
    Plugins/GSD_DailyEvents/Source/GSD_DailyEvents/GSD_DailyEvents.Build.cs
    Plugins/GSD_Core/Source/GSD_Core/GSD_Core.Build.cs
    Plugins/GSD_CityStreaming/Source/GSD_CityStreaming/GSD_CityStreaming.Build.cs
  </files>
  <action>
Verify all other GSD plugin Build.cs files have correct dependencies.

**For each plugin, verify:**

1. **GSD_Vehicles.Build.cs:**
   - Core dependencies: Core, CoreUObject, Engine
   - Chaos physics: ChaosVehicles, ChaosVehiclesCore
   - GSD integration: GSD_Core, GSD_CityStreaming
   - Editor (if bBuildEditor): UnrealEd, AutomationController

2. **GSD_Telemetry.Build.cs:**
   - Core dependencies: Core, CoreUObject, Engine
   - JSON support: Json, JsonUtilities
   - GSD integration: GSD_Core

3. **GSD_ValidationTools.Build.cs:**
   - Core dependencies: Core, CoreUObject, Engine
   - Editor-only: UnrealEd, EditorScriptingUtilities
   - GSD integration: GSD_Core

4. **GSD_DailyEvents.Build.cs:**
   - Core dependencies: Core, CoreUObject, Engine
   - GameplayTags (for event tags)
   - GSD integration: GSD_Core

5. **GSD_Core.Build.cs:**
   - Core dependencies only: Core, CoreUObject, Engine
   - No other GSD plugins (it's the foundation)

6. **GSD_CityStreaming.Build.cs:**
   - Core dependencies: Core, CoreUObject, Engine
   - GSD integration: GSD_Core

**Verification Steps:**
1. Read each Build.cs
2. Check for obvious missing dependencies
3. Ensure no circular dependencies (GSD_Core should have no GSD_* dependencies)
4. Report any issues found

**Important:**
- Only fix CRITICAL missing dependencies
- Do NOT refactor working Build.cs files
- Document any findings for future reference
  </action>
  <verify>
    ```bash
    # Verify GSD_Core has no GSD dependencies (foundation plugin)
    if grep -q "GSD_" Plugins/GSD_Core/Source/GSD_Core/GSD_Core.Build.cs | grep -v "GSD_Core.Build.cs"; then
      echo "WARNING: GSD_Core may have circular dependency"
    else
      echo "✓ GSD_Core has no GSD dependencies"
    fi

    # Check that all Build.cs files exist
    for plugin in GSD_Vehicles GSD_Telemetry GSD_ValidationTools GSD_DailyEvents GSD_Core GSD_CityStreaming; do
      if [ -f "Plugins/$plugin/Source/$plugin/$plugin.Build.cs" ]; then
        echo "✓ $plugin.Build.cs exists"
      else
        echo "✗ $plugin.Build.cs MISSING"
      fi
    done

    echo "Build.cs verification complete"
    ```
  </verify>
  <done>
    - All plugin Build.cs files verified
    - No critical missing dependencies found
    - No circular dependencies detected
    - All plugins ready for compilation
  </done>
</task>

</tasks>

<verification>
1. GSD_Crowds.Build.cs has MassEntity, MassCommon, MassSpawner, GameplayTags
2. All other plugin Build.cs files verified
3. Hot reload succeeds without "missing module" errors
4. No circular dependencies detected
</verification>

<success_criteria>
- All required dependencies declared in Build.cs files
- Hot reload succeeds in editor
- No compilation errors related to missing modules
- Dependency graph is correct (no cycles)
</success_criteria>

<output>
After completion, create `.planning/phases/11-council-fixes/11-02-SUMMARY.md`
</output>
